
## Linux 软件安装
### RPM 安装
    有两种安装包：
    1. 最初的Linux是通过源码包安装的。编译时间长，容易报错。
    （LAMP Linux, Apache, MySQL, PHP网站开发套件。）

    2. 后来出现了二进制包，也就是RPM包，不能看到源码，但安装比源码安装简单。
    再后来出现了yum工具安装以解决RPM包安装的依赖问题。

    RPM安装命令：
    rpm -ivh 软件包全名。
    -i install 安装。
    -v verbose 显示详细信息。
    -h hash 显示进度。

    升级命令：
    rpm -Uvh 包全名。-U update。

    卸载命令：
    rpm -e 包名。-e erase。这里不需要包全名，只要包名（包全名的英文部分）就可以。

    查询命令：
    rpm -q 包名。查询某个包。
    rpm -qa 查询全部安装的包。rpm -qa | grep httpd
    rpm -ql 包名。查询包中各种文件的安装位置。也可以查询未安装的包准备装在哪。
    rpm -qf 系统文件名。查询该文件属于哪个包。

    校验命令：
    rpm -V 包名。查看包中文件是否会更改。

### yum 在线安装
    /etc/yum.repos.d/目录中存在.repo文件。
    repo文件的内容：
    [name]:     容器名称，如[base],[update]。
    name:       容器说明。
    mirrorlist: 镜像站点。
    baseurl:    yum源服务器地址。
    enabled:    容器是否生效，默认生效。
    gpgcheck:   如果是1，RPM数字证书生效。
    gpgkey:     数字证书的公钥保存位置。

    查询命令：
    yum list
    yum search 关键字

    安装命令：
    yum -y install 包名，-y 自动回答yes，而且不需要包全名，包名就可以。

    升级命令：
    yum -y update 包名。如果不写包名，则会升级所有。

    卸载：
    yum -y remove 包名。不建议使用，服务器使用最小化安装，用什么装什么，尽量不卸载。

    yum还支持组安装：
    yum grouplist, yum groupinstall, yum groupremove。

### 源码安装
    make 编译。
    make clear 如果错误，可以清楚已经编译的输出文件。
    make install，安装命令。

    如果删除，则直接删除安装目录。

---

## Linux 服务管理
### 1. 介绍
#### 系统运行级别：
    0. 关机
    1. 单用户模式，主要用于系统修复
    2. 不完全命令模式，不含NFS服务
    3. 完全命令模式，就是标准字符界面
    4. 系统保留
    5. 图形模式
    6. 重启

    runlevel 显示运行级别。
    init 级别号 改变运行级别。

#### 查询服务
    chkconfig --list
    可以看到RPM包安装的服务。会显示服务的自启动状态。

    源码包安装的服务一般在/usr/local/下。

#### 独立服务启动
    RPM包安装的服务会在/etc/init.d/目录下有启动脚本。
    可以通过/etc/init.d/服务名 start|stop|status|restart 来操作。

    也可以通过service命令，（service是redhat系列才有service命令）
    service 服务名 start|stop|status|restart。
    不可以启动源码包安装服务。

#### 独立服务自启动
    chkcofig [--level 运行级别] 服务名 [on|off]
    表示设定运行级别。但是服务的启动状态为不确定，下次开机后自启动。
    比如 chkconfig --level 2345 httpd on
    chkconfig httpd off 关闭自启动。

    可以修改/etc/rc.d/rc.local文件。可以将服务的启动命令放在改文件中。

---

## Linux 权限管理
    服务器应当合理分配权限，一般只有一个管理员，其他人为普通用户。

### 1. 基本权限
    权限位：-rw-r--r-- ,一共10位，第一位为文件类型（- 文件，d 目录，l 软链接）。
    后面每三位为一组，第一组代表所有者u，第二组为所属组g，第三组为其他人o。
    r读，w写，x执行。

#### 基本权限修改 chmod 命令：
    chmod [选项] 模式 文件名

    例如：
    chmod u+x readme.md 给readme.md的所有者u加可执行权限。
    chmod g+w,o+w readme.md 给readme.md的所属组g和其他人o加写权限。
    chmod u-w,g-w,o-w readme.md 去掉readme.md的写权限。
    chmod u=rwx,g=rw readme.md 另一种方式，直接复制。
    chomd a=rwx readme.md a代表所有人。

    用数字代表权限（二进制位）：r -- 4, w -- 2, x -- 1. rwxr-xr-x即755。
    chmod 755 readme.md, 777为最高权限，644读写权限，755可执行权限，这几个比较常用。

#### 权限的作用

    r: 读取文件内容（cat, more, head, tail），可以查看目录下文件名（ls）。
    w: 对文件编辑，新增，修改文件内容（vi, echo），但不包括删除文件。写权限是指对下一级的操作，例如要有对目录的写权限，才可以删除目录下的文件。对目录可新曾，删除，剪切文件和子目录等（touch, rm, mv, cp）。
    x: 对文件的执行权限。对目录可以进入（cd）。

    对文件的最高权限是执行x，对目录的最高权限是写w。对目录可以赋的权限只有0，5，7，其他（1，4，6）没有意义。

#### chown 命令
    修改文件所有者 chown user 文件名。
    chown user:group 文件名可以一次修改所有者和所属组。

#### chgrp 命令
    修改文件所属组 chgrp 组名 文件名
    Linux会在添加用户时，会默认增加和用户名相同的组名。

#### 文件默认权限 umask
    umask 命令，结果022。可以修改mask值。

    文件默认不能建立可执行文件，必须手动赋予，所以文件默认权限最大为666，默认权限和umask换算成字母后相减得到最后权限。
    文件最大权限666（-rw-rw-rw-），umask为022（-----w--w-），再相减为 -rw-r--r--。

    目录的默认权限为777（drwxrwxrwx），umask为022（-----w--w-），换算后相减为755（drwxr-xr-x)。

### 2. 特殊权限
#### sudo 权限
    root把超级用户执行的命令赋予普通用户。sudo的操作对象是系统命令！

    visudo超级用户赋予权限的命令。visudo会打开/etc/sudoers文件，可以赋予普通用户命令。
    例如：visudo 然后键入 user1 ALL=/sbin/shutdown -r now。保存退出。
    
    su命令可以切换用户。
    然后用普通用户，sudo -l可以拆看可以执行的命令（被赋予的）。
    普通用户输入的命令前都要加sudo。


#### su
su命令的主要作用是让你可以在已登录的会话中切换到另外一个用户。这个工具可以让你在不登出当前用户的情况下登录为另外一个用户。

su命令经常被用于切换到超级用户或root用户（因为在命令行下工作，经常需要root权限），su命令也可以用于切换到任意非 root用户。

su命令要求输入的密码是root用户的密码。所以，一般 su 命令需要输入目标用户的密码。在输入正确的密码之后，su 命令会在终端的当前会话中打开一个子会话。

su -
还有一种方法可以切换到 root 用户：运行 su - 命令，如下：

那么，su 命令与 su - 命令之间有什么区别呢？前者在切换到 root 用户之后仍然保持旧的（或者说原始用户的）环境，而后者则是创建一个新的环境（由 root 用户 ~/.bashrc 文件所设置的环境），相当于使用 root 用户正常登录（从登录屏幕登录）。

su 命令手册页很清楚地说明了这一点：

可选参数 - 可提供的环境为用户在直接登录时的环境。

因此，你会觉得使用 su - 登录更有意义。但是， su 命令也是有用的，那么大家可能会想知道它在什么时候用到。以下内容摘自 ArchLinux wiki 网站 - 关于 su 命令的好处和坏处：

有的时候，对于系统管理员（root）来讲，使用其他普通用户的 Shell 账户而不是自己的 root Shell 账户更会好一些。尤其是在处理用户问题时，最有效的方法就是是：登录目标用户以便重现以及调试问题。
然而，在多数情况下，当从普通用户切换到 root 用户进行操作时，如果还使用普通用户的环境变量的话，那是不可取甚至是危险的操作。因为是在无意间切换使用普通用户的环境，所以当使用 root 用户进行程序安装或系统更改时，会产生与正常使用 root 用户进行操作时不相符的结果。例如，以普通用户安装程序会给普通用户意外损坏系统或获取对某些数据的未授权访问的能力。
注意：如果你想在 su - 命令的 - 后面传递更多的参数，那么你必须使用 su -l 而不是 su -。以下是 - 和 -l 命令行选项的说明：

-, -l, --login

提供相当于用户在直接登录时所期望的环境。

当使用 - 时，必须放在 su 命令的最后一个选项。其他选项（-l 和 --login）无此限制。

su -c
还有一个值得一提的 su 命令行选项为：-c。该选项允许你提供在切换到目标用户之后要运行的命令。

su 命令手册页是这样说明：

-c, --command COMMAND

使用 -c 选项指定由 Shell 调用的命令。

被执行的命令无法控制终端。所以，此选项不能用于执行需要控制 TTY 的交互式程序。

参考示例：

su [target-user] -c [command-to-run]
示例中，command-to-run 将会被这样执行：

[shell]&nbsp;-c&nbsp;[command-to-run]
示例中的 shell 类型将会被目标用户在 /etc/passwd 文件中定义的登录 shell 类型所替代。

sudo vs. su
现在，我们已经讨论了关于 su 命令的基础知识，是时候来探讨一下 sudo 和 su 命令之间的区别了。

关于密码
两个命令的最大区别是：sudo 命令需要输入当前用户的密码，su 命令需要输入 root 用户的密码。

很明显，就安全而言，sudo 命令更好。例如，考虑到需要 root 访问权限的多用户使用的计算机。在这种情况下，使用 su 意味着需要与其他用户共享 root 用户密码，这显然不是一种好习惯。

此外，如果要撤销特定用户的超级用户/root 用户的访问权限，唯一的办法就是更改 root 密码，然后再告知所有其他用户新的 root 密码。

而使用 sudo 命令就不一样了，你可以很好的处理以上的两种情况。鉴于 sudo 命令要求输入的是其他用户自己的密码，所以，不需要共享 root 密码。同时，想要阻止特定用户访问 root 权限，只需要调整 sudoers 文件中的相应配置即可。

默认行为
两个命令之间的另外一个区别是其默认行为。sudo 命令只允许使用提升的权限运行单个命令，而 su 命令会启动一个新的 shell，同时允许使用 root 权限运行尽可能多的命令，直到明确退出登录。

因此，su 命令的默认行为是有风险的，因为用户很有可能会忘记他们正在以 root 用户身份进行工作，于是，无意中做出了一些不可恢复的更改（例如：对错误的目录运行 rm -rf 命令！）。关于为什么不鼓励以 root 用户身份进行工作的详细内容，请参考这里。

日志记录
尽管 sudo 命令是以目标用户（默认情况下是 root 用户）的身份执行命令，但是它们会使用 sudoer 所配置的用户名来记录是谁执行命令。而 su 命令是无法直接跟踪记录用户切换到 root 用户之后执行了什么操作。

灵活性
sudo 命令比 su 命令灵活很多，因为你甚至可以限制 sudo 用户可以访问哪些命令。换句话说，用户通过 sudo 命令只能访问他们工作需要的命令。而 su 命令让用户有权限做任何事情。

sudo su
大概是因为使用 su 命令或直接以 root 用户身份登录有风险，所以，一些 Linux 发行版（如 Ubuntu）默认禁用 root 用户帐户。鼓励用户在需要 root 权限时使用 sudo 命令。

然而，您还是可以成功执行 su 命令，而不用输入 root 用户的密码。运行以下命令：

sudo su
由于你使用 sudo 运行命令，你只需要输入当前用户的密码。所以，一旦完成操作，su 命令将会以 root 用户身份运行，这意味着它不会再要求输入任何密码。

PS：如果你想在系统中启用 root 用户帐户（强烈反对，因为你可以使用 sudo 命令或 sudo su 命令），你必须手动设置 root 用户密码，可以使用以下命令：

sudo passwd root
结论
当你需要可用的工具来提升（或一组完全不同的）权限来执行任务时，这篇文章以及之前的教程（其中侧重于 sudo 命令）应该能给你一个比较好的建议。 如果您也想分享关于 su 或 sudo 的相关内容或者经验，欢迎您在下方进行评论。



---

## Linux 系统管理
### 1. 进程管理
    进程是一个正在运行的程序或者命令，有自己的地址空间，占用系统资源。
    进程管理主要是：判断服务器健康状态，查看系统中所有进程，杀死进程。

#### 进程查看命令 ps
    ps aux 查看系统所有进程，BSD操作系统格式。
    ps -le 查看系统所有进程，Linux标准命令格式。(常用ps -ef|grep "xxx")

    ps命令输出：
    USER: 哪个用户产生。
    PID: 进程ID。
    CPU: CPU占比。
    MEM: 物理内存百分比。
    VSZ: 虚拟内存大小，KB。
    RSS: 物理内存大小，KB。
    TTY: 终端，tty1-tty6为本地字符终端，tty7为本地图形终端，pts/0 - xxx是远程终端。如果是？基本为系统进程。
    TIME: 占用CPU时间。
    CMD: 进程名字。

    pstree, 显示进程树。

#### top命令
    top [选项] 每三秒钟刷新一次，默认按CPU占用率排序，可以用上面的几行查看进程是否健康。

    选项：
    -d 秒数，指定每隔几秒更新，默认3秒。
    -b 使用批处理输出，一般和-n合用。
    -n 次数，指定执行top命令次数。
    top -b -n 1 > top.log

    交互命令：
    shift+P 以CPU占用率排序。
    shift+M 以内存占用率排序。
    shift+N 以PID排序。
    q 退出。

最上面的几行：
```
top - 11:05:32 up 462 days,  3:37, 68 users,  load average: 0.09, 0.10, 0.06
Tasks: 739 total,   1 running, 737 sleeping,   1 stopped,   0 zombie
%Cpu(s):  0.2 us,  0.1 sy,  0.0 ni, 98.7 id,  1.0 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem : 16267988 total, 11000276 free,  1124160 used,  4143552 buff/cache
KiB Swap:  8388604 total,  5282652 free,  3105952 used. 14630928 avail Mem 

# top - 系统时间 up 运行时间, 当前登录用户, 1分钟，5分钟，15分钟的平均负载。
# Tasks: 总进程，在运行，休眠，正在停止， 僵尸进程。
# CPU: us用户占用，sy系统占用， ni修改过优先级的用户进程占比， id空闲， wa等待输入输出进程占比，
  hi硬中断请求服务占比, si软终端服务请求占比, st（steal time）虚拟时间占比。
# 内存占用情况。
# 交换分区占比。

Buffer缓冲，加快数据写入。
Cache缓存，加快数据读取。
```

#### 杀死进程
    kill命令, 杀死单一进程
    kill -信号 进程号PID
    kill -l 显示信号，一共64个。

    kill -1 xxx 重启。
    kill -9 xxx 强制杀死。
    kill -15 xxx 默认。

    killall, 批量杀进程
    killall [选项][信号] 进程名。
    例如：killall -i -9 httpd，-i表示交互模式，系统会询问，-I表示忽略进程名字大小写。

    pkill, 也是批量
    pkill [选项][信号] 终端，例如：pkill -9 -t pts/xxx -t表示按终端杀死。

    w命令，可以查看登录用户。

#### 修改进程优先级
    cpu在同一个时钟周期只能运算一个指令。进程优先级决定每个进程的处理顺序。
    ps -le可以显示进程优先级，PRI(priority)和NI(nice)两位都代表优先级。
    用户只能修改NI，但系统最终生效的是PRI。PRI = PRI + NI。
    NI的范围是-20到19，普通用户只能修改0到19，root用户可以修改NI为负值。一般不需要用户去手动调整优先级。

    nice命令用于修改NI值，只能用户新启动的进程优先级，已经存在的不能改。
    nice [选项] 命令。
    举例：nice -n -5 service httpd start，-n表示NI值，后面跟一个进程的启动命令。

    renice [选项] PID用于修改已经存在进程的优先级。

### 2. 工作管理（后台管理）
    工作（jobs）是和终端绑定的，当前终端只能管理当前终端的工作，不能管理其他终端。

    有两种方法将工作放入后台。
    1. 命令 &，可以放入后台的，必须是不用和用户交互的，比如tar命令。如果是top命令，则+&后会是暂停状态。
    2. 命令执行过程中按ctrl+z, 这表示将程序在后台暂停。

    jobs命令可以查看后台进程。jobs -l 可以显示PID号。方括号[xx]中是工作号，还有+表示最后一个放入后台的命令，-表示倒数第二个。
    fg命令把进程恢复到前台，fg %工作号。bg命令把进程再放入后台，bg %工作号。
    如果不加工作号，则按顺序执行(+,-在这里会变化，工作号不会)。

    如果终端关掉，所有该终端的后台进程也会关闭。使进程与终端不绑定的方法：
    1. 放入/etc/rc.local文件。系统启动时调用，不与终端绑定。
    2. 使用系统定时任务。
    3. 使用nohup命令。nohup 命令 &。终端关闭，进程仍然存在。

### 3. 查看系统资源
#### vmstat 命令
    显示系统内存，磁盘和CPU信息
    vmstat [刷新延时 刷新次数]，例如`vmstat 1 3`

```
procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----
 r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st
 1  0 2896312 12693512 404924 2339520    0    0     0     5    0    0  0  0 99  1  0
 0  0 2896312 12694116 404924 2339560    0    0     0     0  226  414  0  0 100  0  0
 0  0 2896312 12693744 404924 2339560    0    0     0     8  208  369  0  0 100  0  0

procs 进程信息字段：
r: 等待运行的进程数，数字越大，系统越繁忙。
b: 不能被唤醒的进程数，数字越大，系统越繁忙。

memory 内存信息字段：
swpd: 虚拟内存使用情况，单位KB。
free: 空闲的内存。
buff: 缓冲的内存。加速数据写入硬盘。
cache: 缓存的内存。加速数据从硬盘的读取。

swap 交换分区：
si: 从磁盘交换到内存的数据量，单位KB。
so: 从内存到磁盘的量。两个数越大，系统性能越差。

io 磁盘读写信息字段：
bi: 从块设备读入数据的总量，单位是块。
bo: 写到块设备的数据量。两个数越大，系统IO越繁忙。

system 系统信息字段：
in: 每秒被中断的进程次数。
cs: 每秒进行的事件切换次数。两个数越大，系统越繁忙。

cpu 处理器信息段：
us: 非内核进程消耗CPU运行时间百分比。
sy: 内核进程。
id: 空闲CPU百分比。越大系统越闲。
wa: 等待IO。
st: 被虚拟机盗用。
```

#### dmesg 命令
    显示内核自检信息
    demesg | grep CPU

#### free 命令
    查看内存使用状态
    free [-b -k -m -g] 选项表示不同的单位，字节，KB，MB，GB。

#### uptime 命令
    其实就是top命令的第一行。

#### uname 命令
    查看内核相关信息。
    uname [-a -r -s] 分别为所有信息，内核版本，内核名称。

#### lsof 命令
    列出进程打开或使用的文件信息。
    lsof | more 显示所有进程调用的文件。
    lsof /sbin/init 查看某个文件被哪个进程调用。
    lsof -c 进程名，如lsof -c httpd 查看httpd进程调用了哪些文件。
    lsof -u 用户名，如lsof -u root 查看root用户的进程调用文件。

### 4. 系统定时任务
#### at 单次任务
    atd有访问控制，/etc/目录下有at.allow文件白名单中的用户可以使用at命令。
    或这at.deny黑名单中的用户不能使用at。
    或者都有但at.allow优先级高。
    如果都没有，则只有root用户可用。

    at [选项] 时间
    -c 工作号：显示at工作的实际内容。
    时间格式：
    HH:MM
    HH:MM YYYY-MM-DD   , 02:30 2019-07-01
    HH:MM [month][date], 02:30 July 25
    HH:MM + [minutes|hours|days|weeks], now + 2 minutes

    at+时间之后会进入at交互模式以输入具体要执行的任务。
    例如：
    at now + 2 minutes
    at> /home/wrma/hello.sh

    atq命令可以查看当前服务器at的工作。

#### crontab 循环定时任务
    与at一样有cron.allow白名单和cron.deny黑名单。

    crontab [选项]
    -e 编辑定时任务。
    -l 查询任务。
    -r 删除当前用户的crontab任务（删除所有任务）。

    crontab -e 后会打开vim。格式是 * * * * * 加上任务或脚本。这个命令会绑定当前用户身份。

    五个星号*代表时间，分别表示：
    1. 一个小时中的第几分钟，范围0-59
    2. 一天当中的第几个小时，范围0-23
    3. 一月当中的第几天，范围1-31
    4. 一年中的第几个月，范围1-12
    5. 一周当中的星期几，0-7（0，7都是星期日）
    最小单位是分钟，最大单位是月。

    特殊符号：
    *表示任意时间，比如第一个*代表一个小时中的每一个分钟都执行一次。
    ,代表不连续时间，比如0 8,12,15 * * * 表示每天8点0分，12点0分，15点0分执行一次命令。
    -代表连续时间，比如0 5 * * 1-6 表示周一到周六每天5点0分执行一次。
    */n 表示每隔多久执行，比如*/10 * * * *代表每隔10分钟执行一次。

    系统的定时任务：
    需要编辑/etc/crontab配置文件下。
    或者直接拷贝要执行的脚本到/etc/cron.{hourly,daily,weekly,monthly}目录中。

#### anacron
    保证系统关机时错过的定时任务，可以在开机后再执行。
    anacron会以一天，一周，一个月作为检测周期。
    系统的/var/spool/anacron/目录中存在cron.{daily,weekly,monthly}文件，记录上次cron的时间。
    和当前时间比较，如果两个值的差超过了anacron的指定时间，则证明cron被漏执行。

    anacron配置文件在/etc/anacrontab，上面的/etc/cron.{daily,weekly,monthly}会被调用。

---

## Linux 网络管理

### 1.基础

#### ISO/OSI七层模型

    OSI,开放系统互联模型。

| Level | 数据单位 | 解释 |
| ----- | ---- | ------- |
| 应用层 | APDU | 用户接口，比如浏览器界面 |
| 表示层 | PPDU | 数据表现形式，ASCII, mp3, jpg, 压缩，加密 |
| 会话层 | SPDU | 管理会话层，比如判断是否给传输层 |
| 传输层 | TPDU | TCP/UDP可靠或不可靠传输，端口号 |
| 网络层 | 报文 | 存着IP地址，用于外网通信 |
| 数据链路层 | 帧 | 帧中存储着MAC地址，也就是网卡的物理地址，负责局域网络 | 
| 物理层 | Bit | 比特流传输，物理接口，电气特性 |

    上层最接近用户。上三层给用户提供服务，没有网络也需要这三层，下四层用于数据传输。
    PDU: Protocol Data Unit。

#### TCP/IP四层模型

| Level | 解释 |
| ----- | ---- |
| 应用层 | 对应OSI上三层 FTP, Telnet, DNS, SMTP|
| 传输层 | OSI 传输层 TCP, UDP|
| 网际互联层 | OSI 网络层 IP协议，IGMP，ICMP互联网控制报文协议(ping)|
| 网络接口层 | OSI 下两层 ARP地址解析协议工作这层| 

#### IP地址与子网掩码

| 类别 | 最大网络数 | IP地址范围 | 最大主机数 | 私有IP地址 |
| --- | --------- | --------- | -------- | ---------- |
| A类 | 126（2^7-2）| 1.0.0.0 -- 126.255.255.255 | 2^24-2 | 10.0.0.0 -- 10.255.255.255 |
| B类 | 2^14 | 128.0.0.0 -- 191.255.255.255 | 2^16-2 | 172.16.0.0 -- 172.31.255.255 |
| C类 | 2^21 | 192.0.0.0 -- 223.255.255.255 | 2^8-2 | 192.168.0.0 -- 192.168.255.255 |

    A类最大网络数减2是因为0.0.0.0 不用，而127.0.0.0表示本地IP。
    公网IP需要付费。但私有IP地址表示免费使用，可以做内网IP，比如学校，办公室等大量使用，可以保护公网IP。
    但私有IP不可以直接访问公网。私有IP数都减2是因为第一个地址为网络地址，最后一个为广播地址。

    路由器是跨网络通信，同一个网络使用交换机通信。

    子网掩码（subnet mask）
    255.0.0.0, 255.255.0.0, 255.255.255.0分别是三类（A, B, C）标准子网掩码。
    IP和子网掩码要一起查看。子网掩码255对应IP的公网段，0对应的私有IP，同一个网段中的主机。

#### 端口号
    用于区分具体服务，一共可以有65536个。传输层到应用层的接口。

    常用端口：
    FTP文件传输协议：20，21
    SSH安全shell协议：22
    telnet远程登录协议：23（不安全，基本已经禁止）
    DNS域名系统：53
    http超文本传输协议：80 （https: 443）
    SMTP简单邮件传输协议：25
    POP3邮局协议3代：110

    /etc/services 文件记录了常规服务的端口号即作用。

#### DNS
    Domain Name System域名解析。早期用hosts文件进行ip和域名的对应，但是维护困难。

    域名空间：
    域名中的点（.）用于分级管理，域名服务器也是分层结构。
    主机名（www）.二级域（ibm, microsoft....）.顶级域（com/org/cn/jp）。域名都是全球唯一的。

#### 网关
    网关（Gateway）又称网间连接器，协议转换器。
    1. 内网计算机访问的不是本网段数据时，就要使用。
    2. 网关负责内网IP和公网IP的互转。

    网关是服务器或路由器。
    一个局域网可以用交换机传递数据，交换机属于数据链路层，所以不认识IP（网络层），交换机认识MAC地址。
    路由器是不同网段之间进行数据交换的。这个路由器就是网关。也可以用服务器搭建网关功能，所以网关也可以是服务器。

### 2.网络配置
#### IP地址配置
    ifconfig命令可以用于查看网络状态和配置IP地址，但只是一次生效，重启之后就会恢复。

    ifconfig结果：
    lo表示loopback网卡，本地地址127.0.0.1，这个网卡只是说明当前主机的网络协议正常。

    eth0表示第一块网卡：
    IP地址 inet 10.2.1.56
    子网掩码 netmask 255.255.255.0
    广播地址 broadcast 10.2.1.255
    还有接收包，发送包的信息等。

    ifconfig命令配置网络:
    ifconfig etho 192.168.0.200 netmask 255.255.255.0

#### linux网络配置文件
    网卡配置文件位置：/etc/sysconfig/network-scripts/ifcfg-eth0

    内容：
    DEVICE=eth0 名字必须和文件匹配
    TYPE=Ethernet
    NAME="eth0"
    ONBOOT=yes
    BOOTPROTO=dhcp 也可以是none, static
    IPV6INIT=no
    PEERDNS=no

    hostname命令可以用于查看主机名。
    主机名文件：/etc/sysconfig/network

    DNS文件：/etc/resolv.conf
    nameserver:名称服务器。

### 3.网络命令
#### 环境查看命令
    ifconfig 只能查看ip和子网掩码和广播地址，不能看到网关和DNS。

    ifup ifdown命令用于开启和关闭网卡。例如ifdown lo, ifup lo.

    netstat命令：
    -t TCP端口号。
    -u UDP端口号。
    -l 仅列出在监听状态的网络服务。
    -a 查看所有连接和端口。
    -n 显示IP和端口号，不显示域名和服务器。
    -p 显示PID。

```
例如 netstat -tuln
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State
tcp        0      0 0.0.0.0:3306            0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:587             0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:9100            0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:20088           0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:8089            0.0.0.0:*               LISTEN
tcp        0      0 127.0.0.1:199           0.0.0.0:*               LISTEN
udp        0      0 0.0.0.0:68              0.0.0.0:*
udp        0      0 0.0.0.0:111             0.0.0.0:*
udp        0      0 0.0.0.0:161             0.0.0.0:*
udp        0      0 127.0.0.1:323           0.0.0.0:*
udp        0      0 127.0.0.1:25375         0.0.0.0:*
udp        0      0 0.0.0.0:947             0.0.0.0:*
udp        0      0 0.0.0.0:58773           0.0.0.0:*
udp        0      0 0.0.0.0:10144           0.0.0.0:*
```

    再例如：
    netstat -an | grep ESTABLISHED 显示建立的远程连接。
    netstat -an | grep ESTABLISHED | wc -l 统计建立的远程连接。

    netstat -rn 列出所有路由，最后一个就是网关。
    route -n 与上面的命令一致。

    nslookup 进行域名与IP的解析。
    例如nslookup localhost, nslookup www.taobao.com。

#### 网络测试命令
    ping命令，ping ip或域名。-c 次数，可以限定ping的次数。
    例如：ping www.taobao.com -c 10

    telnet命令，telnet ip或域名 端口号，可以测试服务器端口是否开启。
    例如：telnet www.taobao.com 80 （ctrl+] quit退出）。

    traceroute命令，traceroute ip或域名，路由跟踪。
    例如：traceroute www.google.com。

    wget命令，下载命令。

    tcpdump命令，用于抓包。
    例如：tcpdump -i eth0 -nnX prot 21
    -i 指定网卡。
    -nn 将数据包中的域名和服务转为IP和端口。
    -X 16进制显示。
    port 端口号。

### 4.远程登录

#### SSH
    对称加密算法，一个秘钥可以同时用作信息加密和解密，也叫单秘钥加密。
    非对称加密算法，有两个秘钥，公开和私有（public key and private key）。
    想象一个房间有两扇门，一个是管理员的公钥和密码加密，另一个是用户的公钥和密码，这样两人都能开门，但彼此不知道密码，比对称加密更安全。

    SSH即Secure Shell，用的是非对称加密策略。

    ssh命令：
    ssh 用户名@ip(或主机名)。用户名可以省略，表示用当前用户登录。exit命令退出。
    第一ssh会提示下载主机的ssh公钥，存于.ssh目录下。

    scp命令：
    scp [-r] 用户名@ip:文件路径 本地路径 用于下载文件。
    scp [-r] 粉底文件 用户名@ip:文件路径 用于上传文件。-r表示目录。



## DNS

权威域名解析

记录类型：
A记录
CNAME
NS记录
MX记录：针对邮件服务解析，配合A记录使用